<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Interactive Fireworks</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: black;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Resize canvas to fill window
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

    // Array to store all active particles
    let particles = [];

    class Particle {
        constructor(x, y, type) {
        this.x = x;
        this.y = y;
        
        // Default random color and size
        this.hue = Math.random() * 360;
        this.size = Math.random() * 3 + 2;
        this.alpha = 1;
        this.friction = 0.98;
        this.gravity = 0.05;

        // --- SHAPE LOGIC ---
        const t = Math.random() * Math.PI * 2; // Random angle
        const velocity = Math.random() * 5 + 2; // Base speed

        switch (type) {
            case 'heart':
                // Heart Math
                const speedH = 0.15;
                const heartX = 16 * Math.pow(Math.sin(t), 3);
                const heartY = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
                this.dx = heartX * speedH;
                this.dy = -heartY * speedH;
                break;

            case 'star':
                // Star Math
                // We create spikes by multiplying speed by a wave function (5 spikes)
                const starSpeed = velocity * (1 + Math.sin(t * 5)); 
                this.dx = Math.cos(t) * starSpeed;
                this.dy = Math.sin(t) * starSpeed;
                break;

            default:
                // ðŸ”µ Circle Math (The Original)
                this.dx = Math.cos(t) * velocity;
                this.dy = Math.sin(t) * velocity;
                break;
        }
    }

        
        draw() {
            ctx.save();
            ctx.globalAlpha = this.alpha;
            ctx.beginPath();
            // BURN OUT : Use this.size instead of a fixed number 
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            // RAINBOW : Use HSL coor string
            ctx.fillStyle = 'hsl(' + this.hue + ', 100%, 50%)';
            ctx.fill();
            ctx.restore();
        }

        update() {
            this.draw();
            this.dx *= this.friction;
            this.dy *= this.friction;
            this.dy += this.gravity;
            
            this.x += this.dx;
            this.y += this.dy;
            
            this.alpha -= 0.01; // Fade out
            this.hue += 2; // Rainbow: rotating the color frame by 2 degres per frame
            if (this.size > 0.1) this.size -= 0.05;
        }
    }

    // Trigger explosion on click
    const explosionSound = new Audio('https://www.soundjay.com/mechanical/sounds/explosion-01.mp3');
    window.addEventListener('click', (event) => {
        const x = event.clientX;
        const y = event.clientY;

        // Play sound ONCE
        explosionSound.currentTime = 0; // Rewind sound so it can play fast
        explosionSound.play();
        // 1. Pick a random shape for THIS explosion
        const shapes = ['circle', 'heart', 'star'];
        const randomShape = shapes[Math.floor(Math.random() * shapes.length)];

        // 2. Loop to create particles
        for (let i = 0; i < 400; i++) {
        // Pass the randomShape to the new particle
        particles.push(new Particle(x, y, randomShape));
        }
        
    });
    // RANDOM TRIGGER CODE:
    setInterval(() => {
        //  Picking a random positon
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height;
        const shapes = ['circle', 'heart', 'star'];
        const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
       // Spawning particles 
       for( let i = 0; i < 500; i++){
        particles.push(new Particle(x,y, randomShape));
       
       }
    }, 800); // trigger every 800 ms



    // Animation Loop
    function animate() {
        requestAnimationFrame(animate);
        
        // This creates the "trail" effect by not clearing the screen completely
        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)'; 
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        particles.forEach((particle, index) => {
            if (particle.alpha > 0) {
                particle.update();
            } else {
                particles.splice(index, 1); // Remove dead particles
            }
        });
    }

    animate();
</script>

</body>
</html>